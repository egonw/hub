#!/usr/bin/env bash

set -eu

wd sparql ./scripts/assets/properties.rq --index property > ./scripts/assets/properties.json

# Using printf to avoid getting an undesired newline break
printf "// Generated by scripts/update_properties\nmodule.exports = " > ./lib/properties.js
./scripts/get_properties_index >> ./lib/properties.js

# If standard is installed, fix possible indentation inconsistencies
# to avoid having standard report them later
standard --fix ./lib/properties.js || echo 'not linting'

echo "generating properties index"
./scripts/generate_properties_index

echo "copying the index in the public folder to make it publicly accessible"
cp ./lib/properties_index.js ./public/properties_index.js

echo "generating properties links data"
./scripts/generate_links_data
